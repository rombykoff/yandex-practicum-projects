# Исследование объявлений о продаже квартир

В вашем распоряжении данные сервиса Яндекс.Недвижимость — архив объявлений о продаже квартир в Санкт-Петербурге и соседних населённых пунктов за несколько лет. Нужно научиться определять рыночную стоимость объектов недвижимости. Ваша задача — установить параметры. Это позволит построить автоматизированную систему: она отследит аномалии и мошенническую деятельность. 

По каждой квартире на продажу доступны два вида данных. Первые вписаны пользователем, вторые — получены автоматически на основе картографических данных. Например, расстояние до центра, аэропорта, ближайшего парка и водоёма. 

<a id='intro'></a>

<h1>Содержание<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Откройте-файл-с-данными-и-изучите-общую-информацию." data-toc-modified-id="Откройте-файл-с-данными-и-изучите-общую-информацию.-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Откройте файл с данными и изучите общую информацию.</a></span></li><li><span><a href="#Предобработка-данных" data-toc-modified-id="Предобработка-данных-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Предобработка данных</a></span><ul class="toc-item"><li><span><a href="#Переименование-столбца" data-toc-modified-id="Переименование-столбца-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Переименование столбца</a></span></li><li><span><a href="#Столбец-total_images" data-toc-modified-id="Столбец-total_images-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>Столбец <code>total_images</code></a></span></li><li><span><a href="#Столбец-last_price" data-toc-modified-id="Столбец-last_price-2.3"><span class="toc-item-num">2.3&nbsp;&nbsp;</span>Столбец <code>last_price</code></a></span></li><li><span><a href="#Столбец-total_area" data-toc-modified-id="Столбец-total_area-2.4"><span class="toc-item-num">2.4&nbsp;&nbsp;</span>Столбец <code>total_area</code></a></span></li><li><span><a href="#Столбец-first_day_exposition" data-toc-modified-id="Столбец-first_day_exposition-2.5"><span class="toc-item-num">2.5&nbsp;&nbsp;</span>Столбец <code>first_day_exposition</code></a></span></li><li><span><a href="#Столбец-rooms" data-toc-modified-id="Столбец-rooms-2.6"><span class="toc-item-num">2.6&nbsp;&nbsp;</span>Столбец <code>rooms</code></a></span></li><li><span><a href="#Столбец-ceiling_height" data-toc-modified-id="Столбец-ceiling_height-2.7"><span class="toc-item-num">2.7&nbsp;&nbsp;</span>Столбец <code>ceiling_height</code></a></span></li><li><span><a href="#Столбец-floors_total" data-toc-modified-id="Столбец-floors_total-2.8"><span class="toc-item-num">2.8&nbsp;&nbsp;</span>Столбец <code>floors_total</code></a></span></li><li><span><a href="#Столбец-living_area" data-toc-modified-id="Столбец-living_area-2.9"><span class="toc-item-num">2.9&nbsp;&nbsp;</span>Столбец <code>living_area</code></a></span></li><li><span><a href="#Столбец-floor" data-toc-modified-id="Столбец-floor-2.10"><span class="toc-item-num">2.10&nbsp;&nbsp;</span>Столбец <code>floor</code></a></span></li><li><span><a href="#Столбец-is_apartment" data-toc-modified-id="Столбец-is_apartment-2.11"><span class="toc-item-num">2.11&nbsp;&nbsp;</span>Столбец <code>is_apartment</code></a></span></li><li><span><a href="#Столбец--studio" data-toc-modified-id="Столбец--studio-2.12"><span class="toc-item-num">2.12&nbsp;&nbsp;</span>Столбец  <code>studio</code></a></span></li><li><span><a href="#Столбец-open_plan" data-toc-modified-id="Столбец-open_plan-2.13"><span class="toc-item-num">2.13&nbsp;&nbsp;</span>Столбец <code>open_plan</code></a></span></li><li><span><a href="#Столбец-kitchen_area" data-toc-modified-id="Столбец-kitchen_area-2.14"><span class="toc-item-num">2.14&nbsp;&nbsp;</span>Столбец <code>kitchen_area</code></a></span></li><li><span><a href="#Столбец-balcony" data-toc-modified-id="Столбец-balcony-2.15"><span class="toc-item-num">2.15&nbsp;&nbsp;</span>Столбец <code>balcony</code></a></span></li><li><span><a href="#Столбец-locality_name" data-toc-modified-id="Столбец-locality_name-2.16"><span class="toc-item-num">2.16&nbsp;&nbsp;</span>Столбец <code>locality_name</code></a></span></li><li><span><a href="#Столбец-airports_nearest" data-toc-modified-id="Столбец-airports_nearest-2.17"><span class="toc-item-num">2.17&nbsp;&nbsp;</span>Столбец <code>airports_nearest</code></a></span></li><li><span><a href="#Столбец-city_centers_nearest" data-toc-modified-id="Столбец-city_centers_nearest-2.18"><span class="toc-item-num">2.18&nbsp;&nbsp;</span>Столбец <code>city_centers_nearest</code></a></span></li><li><span><a href="#Столбец-parks_around3000" data-toc-modified-id="Столбец-parks_around3000-2.19"><span class="toc-item-num">2.19&nbsp;&nbsp;</span>Столбец <code>parks_around3000</code></a></span></li><li><span><a href="#Столбец-parks_nearest" data-toc-modified-id="Столбец-parks_nearest-2.20"><span class="toc-item-num">2.20&nbsp;&nbsp;</span>Столбец <code>parks_nearest</code></a></span></li><li><span><a href="#Столбец-ponds_around3000" data-toc-modified-id="Столбец-ponds_around3000-2.21"><span class="toc-item-num">2.21&nbsp;&nbsp;</span>Столбец <code>ponds_around3000</code></a></span></li><li><span><a href="#Столбец-ponds_nearest" data-toc-modified-id="Столбец-ponds_nearest-2.22"><span class="toc-item-num">2.22&nbsp;&nbsp;</span>Столбец <code>ponds_nearest</code></a></span></li><li><span><a href="#Столбец-days_exposition" data-toc-modified-id="Столбец-days_exposition-2.23"><span class="toc-item-num">2.23&nbsp;&nbsp;</span>Столбец <code>days_exposition</code></a></span></li><li><span><a href="#Поиск-и-удаление-дубликатов" data-toc-modified-id="Поиск-и-удаление-дубликатов-2.24"><span class="toc-item-num">2.24&nbsp;&nbsp;</span>Поиск и удаление дубликатов</a></span></li><li><span><a href="#Изменение-типов-данных" data-toc-modified-id="Изменение-типов-данных-2.25"><span class="toc-item-num">2.25&nbsp;&nbsp;</span>Изменение типов данных</a></span></li><li><span><a href="#Вывод" data-toc-modified-id="Вывод-2.26"><span class="toc-item-num">2.26&nbsp;&nbsp;</span>Вывод</a></span></li></ul></li><li><span><a href="#Посчитайте-и-добавьте-в-таблицу-новые-столбцы" data-toc-modified-id="Посчитайте-и-добавьте-в-таблицу-новые-столбцы-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Посчитайте и добавьте в таблицу новые столбцы</a></span><ul class="toc-item"><li><span><a href="#Цена-одного-квадратного-метра" data-toc-modified-id="Цена-одного-квадратного-метра-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span>Цена одного квадратного метра</a></span></li><li><span><a href="#День-недели-публикации-объявления-|-Месяц-публикации-объявления-|-Год-публикации-объявления" data-toc-modified-id="День-недели-публикации-объявления-|-Месяц-публикации-объявления-|-Год-публикации-объявления-3.2"><span class="toc-item-num">3.2&nbsp;&nbsp;</span>День недели публикации объявления | Месяц публикации объявления | Год публикации объявления</a></span></li><li><span><a href="#Тип-этажа-квартиры" data-toc-modified-id="Тип-этажа-квартиры-3.3"><span class="toc-item-num">3.3&nbsp;&nbsp;</span>Тип этажа квартиры</a></span></li><li><span><a href="#Расстояние-до-центра-города-в-километрах" data-toc-modified-id="Расстояние-до-центра-города-в-километрах-3.4"><span class="toc-item-num">3.4&nbsp;&nbsp;</span>Расстояние до центра города в километрах</a></span></li></ul></li><li><span><a href="#Проведите-исследовательский-анализ-данных" data-toc-modified-id="Проведите-исследовательский-анализ-данных-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Проведите исследовательский анализ данных</a></span><ul class="toc-item"><li><span><a href="#Изучаем-параметры-объектов" data-toc-modified-id="Изучаем-параметры-объектов-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>Изучаем параметры объектов</a></span></li><li><span><a href="#Изучаем,-как-быстро-продавались-квартиры" data-toc-modified-id="Изучаем,-как-быстро-продавались-квартиры-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>Изучаем, как быстро продавались квартиры</a></span></li><li><span><a href="#Факторы-больше-всего-влияющие-на-общую-(полную)-стоимость-объекта" data-toc-modified-id="Факторы-больше-всего-влияющие-на-общую-(полную)-стоимость-объекта-4.3"><span class="toc-item-num">4.3&nbsp;&nbsp;</span>Факторы больше всего влияющие на общую (полную) стоимость объекта</a></span></li><li><span><a href="#Средняя-цена-одного-квадратного-метра." data-toc-modified-id="Средняя-цена-одного-квадратного-метра.-4.4"><span class="toc-item-num">4.4&nbsp;&nbsp;</span>Средняя цена одного квадратного метра.</a></span></li><li><span><a href="#Средняя-цена-километра-в-Санкт-Петербурге" data-toc-modified-id="Средняя-цена-километра-в-Санкт-Петербурге-4.5"><span class="toc-item-num">4.5&nbsp;&nbsp;</span>Средняя цена километра в Санкт-Петербурге</a></span></li></ul></li><li><span><a href="#Общий-вывод" data-toc-modified-id="Общий-вывод-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>Общий вывод</a></span></li></ul></div>

**Описание данных**

`airports_nearest` — расстояние до ближайшего аэропорта в метрах (м)  
`balcony` — число балконов  
`ceiling_height` — высота потолков (м)  
`cityCenters_nearest` — расстояние до центра города (м)  
`days_exposition` — сколько дней было размещено объявление (от публикации до снятия)  
`first_day_exposition` — дата публикации  
`floor` — этаж  
`floors_total` — всего этажей в доме  
`is_apartment` — апартаменты (булев тип)  
`kitchen_area` — площадь кухни в квадратных метрах (м²)  
`last_price` — цена на момент снятия с публикации  
`living_area` — жилая площадь в квадратных метрах (м²)  
`locality_name` — название населённого пункта  
`open_plan` — свободная планировка (булев тип)  
`parks_around3000` — число парков в радиусе 3 км  
`parks_nearest` — расстояние до ближайшего парка (м)  
`ponds_around3000` — число водоёмов в радиусе 3 км  
`ponds_nearest` — расстояние до ближайшего водоёма (м)  
`rooms` — число комнат  
`studio` — квартира-студия (булев тип)  
`total_area` — общая площадь квартиры в квадратных метрах (м²)  
`total_images` — число фотографий квартиры в объявлении

# Общий вывод

[Содержание](#intro)

Для анализа была дана база с информацией по продаже квартир. Состоял из 22 колонок и 23699 строк. 
В процессе предобработки было удалено 17 строк (осталось 23682 строк, удалено 0,07% данных) - это хорошо.

Далее:
- в стлобце `ceiling_height` пропуски заменены медианами. И здесь были обнаружены ошибочные значения, в которых небыло запятой - исправили;
- столбец `first_day_exposition` приведен к типу datetime64;
- в столбцах `living_area` и `kitchen_area` произведена замена медианами в зависимости от общей площади. Так же учтены квартиры студии - в строках для студии в столбце`kitchen_area` постевлено 0;
- в числовых столбцах заменены типы на int, кроме столбцов с площадями и расстояниями(округлено до 0,1);
- в столбце `days_exposition` пропуски заполненны медианами в зависимости от населенного пункта;
- обрезаны сильные выбросы в столбцах где они имели место;
- удалено 3 дубликата;

По заданию было добавлено 7 столбцов, в которых были подсчитаны дополнительные параметры:
- цена квадратного метра;
- день недели, месяц и год публикации объявления;
- тип этажа квартиры (значения — «первый», «последний», «другой»);
- соотношение жилой и общей площади, а также отношение площади кухни к общей.

Был проведен анализ и сделаны выводы:

Больше всего квартир с площадями 30-60 кв.м - это самые популярные 1 и 2-х комнатные. Следом идут 3 комнатные с площадью до 80 кв.м. Типичное расположение этих квартир с 1 по 10 этаж.
Так же можно заметить, что по мере роста площади квартир, их количество начинает убывать - обратная зависимость. Также квартиры меньше 30 кв.м тоже довольно редки.
Распределение более похоже на распределение Пуассона.
Видна чёткая зависимость жилой и кухонной площадей от общей. С ростом площади уменьшается количество квартир.
Наиболее популярна жилая площадь от 15 до 40 метров, кухня от 7 до 10 квадратных метра.
На графике с жилой площадью заметен провал в районе 25 кв.м., скорее всего, это связано с переходом от однокомнатных квартир к двухкомнатным (первый всплеск - количество 1 + 2 комнатных квартир, второй - только 2 комнатные). Проще говоря, однокомнатных квартир с жилой площадью 25 кв.м. мало, а двухкомнатных с такой площадью еще нет или их количество равнозначно мало. 
Больше всего квартир с высотой потолков 2.5 - 3 м из них подавляющее большинство с высотой 2,6 - 2,7 см. Остальное - нестандартный размер и чем выше - тем реже встречается. Ниже нормального диапазона - тоже большая редкость. Похоже на распределение Пуассона

Видно, что больше всего квартир продается в пяти и девятиэтажных домах, скорее всего это самые распространенные дома советской постройки в старых районах города. 

Заметно, что наибольше количество квартир продаются по цене в диапазоне 2 - 7 млн.руб. Основная масса продается в цене около 4 мнн. А в остальных случаях чем ниже или выше цена количество объявлений пропорционально падает. Распределение более похоже на распределение Пуассона.

Логично, что больше всего квартир продается в "середине дома", так как дома в основном многоэтажные. Количество объявлений с типом "последний" чуть больше, возможно из-за того, что квартиры на первых этажах сдаются в аренду как коммерческая недвижимость.

Чаще всего объявления публикуются в буднии дни, скорее всего это связано с графиком работы риелторов.

Больше всего объявлений опубликовано в декабре, возможно это связано с несколькими факторами:

- стремлением сделать подарок на НГ;
- продать "подороже", так как перед НГ спрос всегда увеличивается;
- продать квартиру перед началом календарного года, чтобы потом не платить налог.
Так же много объявлений подается в весенние месяцы, в этот период как правило спрос тоже увеличивается.

На графикав видно, что больше всего квартир продается на расстоянии от 12 до 15км.
Растояния до аэропорта приобладает в промежутке 15 - 40 км.
Растояние до парка от нескольких метров до 750.
На всех трех графиках видны отдельные пиковые значения. Из этого можно сделать вывод, что большое количество данных взято из одного населенного пункта.

Наблюдается слабая зависимость количества объявлений от растояния до парка. При этом обратная картина для расстояния до центра или аэропорта (чем больше расстояние, тем меньше объявлений).
На графиках видно, что больше всего квартир продается (примерно) за 45 и 60 дней (пиковые значения на первой и второй гистограммах). На 90 днях так же заметен скачек, возможно есть алгоритм закрывающий объявления в этот срок автоматически или запрашивающий подтверждение у владельца. 

Все что продается раньше 40 дней можно назвать быстрой продажей (находится до первого пика). Долгими продажами будем считать все после 100 дней.
К необычно долгим я бы отнес все после 200 дней - третий квартиль, отсечка 3 четвертей(75% значений)

На последней гистограмме мы видим большое количество обьявлений которые, скорее всего, на момент сбора данных были актуальны.

Факторы больше всего влияющие на стоимость квартиры: 

Больше всего на стоимость квартиры влияет её площадь(прямопропорцианальная зависимость). Среднее влияние оказывает жилая площадь и площадь кухни. Количество комнат и тип этажа вляют меньше всего. Дата размещения не оказывает влияния на цену. Стоит обратить внимание на тип этажа, есть существенная разница между первым и последним этажами

По гистограмме видно, что наибольшая цена на расстоянии до 1 км от центра (около 32 млн.р за квартиру) и сильно меняется уже после 1 км. от центра (17 млн.р за квартиру)
Радиус до 1 км от центра - это "самый центр".
Еще одна граница находится в районе 7 км от центра, после которой следует сильное падение цены (с 15 млн до 9 млн) и после начинает убывать постепенно.
Сильный скачек в конце гистграммы связан с одной дорогой квартирой стоимостью 17 122 148 и площадью 178.3.
